<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WEALTHOPIA ‚Äî Order Form</title>
  <style>
    :root{
      --bg:#0b0f14; --card:#111827; --muted:#9ca3af; --text:#e5e7eb;
      --line:#1f2937; --accent:#22c55e; --accent2:#38bdf8; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{padding:22px 16px;border-bottom:1px solid var(--line);position:sticky;top:0;background:rgba(11,15,20,.9);backdrop-filter: blur(6px);z-index:10}
    .wrap{max-width:1100px;margin:0 auto}
    h1{margin:0;font-size:22px;letter-spacing:.5px}
    .sub{color:var(--muted);margin-top:6px;font-size:13px}
    main{padding:18px 16px 40px}
    .grid{display:grid;grid-template-columns: 1.3fr .9fr;gap:16px}
    @media (max-width: 940px){.grid{grid-template-columns:1fr}}
    .panel{background:var(--card);border:1px solid var(--line);border-radius:16px;overflow:hidden}
    .panel-h{padding:14px 14px;border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between;gap:10px}
    .panel-h h2{margin:0;font-size:14px;font-weight:700;letter-spacing:.4px}
    .pill{font-size:12px;color:var(--muted)}
    .panel-b{padding:14px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{border:1px solid var(--line);background:transparent;color:var(--text);padding:8px 10px;border-radius:999px;cursor:pointer;font-size:12px}
    .tab[aria-selected="true"]{border-color:rgba(34,197,94,.6);box-shadow:0 0 0 2px rgba(34,197,94,.15) inset}
    .items{margin-top:12px;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    @media (max-width: 560px){.items{grid-template-columns:1fr}}
    .item{border:1px solid var(--line);border-radius:14px;padding:12px;display:flex;flex-direction:column;gap:10px}
    .item-top{display:flex;justify-content:space-between;gap:10px}
    .name{font-weight:700}
    .price{color:var(--accent2);font-weight:700;font-size:12px;white-space:nowrap}
    .muted{color:var(--muted);font-size:12px}
    .row{display:flex;gap:8px;align-items:center}
    input[type="number"], input[type="text"], textarea{
      width:100%;background:#0c1220;border:1px solid var(--line);color:var(--text);
      padding:10px 10px;border-radius:12px;outline:none
    }
    input[type="number"]{max-width:140px}
    textarea{min-height:84px;resize:vertical}
    .btn{
      border:1px solid var(--line);background:#0c1220;color:var(--text);
      padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:700
    }
    .btn-primary{background:rgba(34,197,94,.14);border-color:rgba(34,197,94,.55)}
    .btn-primary:hover{background:rgba(34,197,94,.2)}
    .btn-danger{background:rgba(239,68,68,.12);border-color:rgba(239,68,68,.55)}
    .cart{display:flex;flex-direction:column;gap:10px}
    .cart-item{border:1px solid var(--line);border-radius:14px;padding:12px;display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center}
    .cart-item .meta{display:flex;flex-direction:column;gap:4px}
    .cart-item .meta .small{color:var(--muted);font-size:12px}
    .cart-item .right{display:flex;gap:8px;align-items:center}
    .totalbox{border-top:1px solid var(--line);margin-top:12px;padding-top:12px;display:grid;gap:8px}
    .kv{display:flex;justify-content:space-between;gap:10px;color:var(--muted);font-size:13px}
    .kv strong{color:var(--text)}
    .warn{padding:10px 12px;border-radius:12px;border:1px dashed rgba(239,68,68,.6);background:rgba(239,68,68,.07);color:#fecaca;font-size:12px}
    .ok{padding:10px 12px;border-radius:12px;border:1px dashed rgba(34,197,94,.6);background:rgba(34,197,94,.07);color:#bbf7d0;font-size:12px}
    .foot{margin-top:10px;color:var(--muted);font-size:12px;line-height:1.5}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <h1>WEALTHOPIA ‚Äî Order Form</h1>
    <div class="sub">Masukkan item ke keranjang (kelipatan 100). Total minimal 100 item. Klik ‚ÄúKirim ke WhatsApp‚Äù untuk order otomatis.</div>
  </div>
</header>

<main class="wrap">
  <div class="grid">

    <!-- LEFT: PRODUCT PICKER -->
    <section class="panel">
      <div class="panel-h">
        <h2>Pilih Item</h2>
        <div class="pill">Harga dihitung otomatis</div>
      </div>
      <div class="panel-b">
        <div class="tabs" id="tabs"></div>
        <div class="items" id="items"></div>
        <div class="foot">
          <div><strong>Catatan:</strong> Input <span class="mono">Qty</span> harus kelipatan 100 (100, 200, 300, dst.).</div>
        </div>
      </div>
    </section>

    <!-- RIGHT: CART + CUSTOMER -->
    <aside class="panel">
      <div class="panel-h">
        <h2>Keranjang & Checkout</h2>
        <div class="pill" id="cartCount">0 item</div>
      </div>
      <div class="panel-b">
        <div class="cart" id="cart"></div>

        <div class="totalbox">
          <div class="kv"><span>Total Qty</span><strong id="totalQty">0</strong></div>
          <div class="kv"><span>Total Harga</span><strong id="totalPrice">Rp0</strong></div>

          <div id="ruleBox" class="warn" style="display:none;">
            Total minimal 100 item dan setiap item harus kelipatan 100.
          </div>
          <div id="okBox" class="ok" style="display:none;">
            Siap dikirim. Klik ‚ÄúKirim ke WhatsApp‚Äù.
          </div>
        </div>

        <hr style="border:none;border-top:1px solid var(--line);margin:14px 0">

        <div style="display:grid;gap:10px">
          <div>
            <div class="muted" style="margin-bottom:6px">Nama</div>
            <input id="custName" type="text" placeholder="Contoh: Dini" />
          </div>
          <div>
            <div class="muted" style="margin-bottom:6px">Username Heartopia</div>
            <input id="custUser" type="text" placeholder="Contoh: @username" />
          </div>
          <div>
            <div class="muted" style="margin-bottom:6px">Catatan (opsional)</div>
            <textarea id="custNote" placeholder="Contoh: Tolong fokus blueberry dulu, lalu rasberry."></textarea>
          </div>

          <button class="btn btn-primary" id="sendWA">Kirim ke WhatsApp</button>
          <button class="btn btn-danger" id="clearCart">Kosongkan Keranjang</button>

          <div class="foot">
            <div><strong>Ubah nomor WhatsApp:</strong> edit variabel <span class="mono">WA_NUMBER</span> di bagian script.</div>
            <div>Format WA: kode negara tanpa ‚Äú+‚Äù. Contoh Indonesia: <span class="mono">6281234567890</span></div>
          </div>
        </div>
      </div>
    </aside>

  </div>
</main>

<script>
  // ==============================
  // CONFIG
  // ==============================
  const WA_NUMBER = "6283197962700"; // <-- GANTI jadi nomor WA kamu (tanpa +)
  const BRAND = "WEALTHOPIA";

  // Harga satuan per 1 item (dari rangkuman kamu)
  const CATALOG = {
    Fruits: [
      { id:"blueberry", label:"ü´ê Blueberry", unit:30 },
      { id:"apple",     label:"üçé Apple",     unit:30 },
      { id:"rasberry",  label:"üçì Rasberry",  unit:40 },
      { id:"mandarin",  label:"üçä Mandarin",  unit:40 },
    ],
    Mushrooms: [
      { id:"mushroom",  label:"üçÑ Mushroom",  unit:25 },
      // kalau mau tambah jenis lain (oyster/shiitake/button), cukup copy baris ini:
      // { id:"oyster", label:"üçÑ Oyster", unit:25 },
    ],
    Materials: [
      { id:"stone", label:"ü™® Stone", unit:23 },
      { id:"ore",   label:"‚õèÔ∏è Ore",   unit:28 },
    ],
  };

  const STEP = 100; // kelipatan 100

  // ==============================
  // STATE
  // ==============================
  /** cart: { [id]: {id,label,unit,qty} } */
  const cart = {};

  // ==============================
  // HELPERS
  // ==============================
  const rupiah = (n) => "Rp" + Math.round(n).toLocaleString("id-ID");
  const clampQty = (v) => {
    const num = Number(v);
    if (!Number.isFinite(num) || num <= 0) return 0;
    // round down to nearest STEP
    return Math.floor(num / STEP) * STEP;
  };

  const getAllItems = () => Object.values(CATALOG).flat();

  // ==============================
  // UI RENDER
  // ==============================
  const tabsEl = document.getElementById("tabs");
  const itemsEl = document.getElementById("items");
  const cartEl  = document.getElementById("cart");
  const cartCountEl = document.getElementById("cartCount");
  const totalQtyEl = document.getElementById("totalQty");
  const totalPriceEl = document.getElementById("totalPrice");
  const ruleBox = document.getElementById("ruleBox");
  const okBox = document.getElementById("okBox");

  let activeTab = Object.keys(CATALOG)[0];

  function renderTabs(){
    tabsEl.innerHTML = "";
    Object.keys(CATALOG).forEach((cat)=>{
      const b = document.createElement("button");
      b.className = "tab";
      b.textContent = cat;
      b.setAttribute("aria-selected", String(cat===activeTab));
      b.addEventListener("click", ()=>{
        activeTab = cat;
        renderTabs();
        renderItems();
      });
      tabsEl.appendChild(b);
    });
  }

  function renderItems(){
    const list = CATALOG[activeTab];
    itemsEl.innerHTML = "";
    list.forEach((it)=>{
      const card = document.createElement("div");
      card.className = "item";

      const top = document.createElement("div");
      top.className = "item-top";
      top.innerHTML = `
        <div>
          <div class="name">${it.label}</div>
          <div class="muted">Kelipatan ${STEP}</div>
        </div>
        <div class="price">${rupiah(it.unit)}/item<br><span class="muted">${rupiah(it.unit*STEP)}/100</span></div>
      `;

      const row = document.createElement("div");
      row.className = "row";

      const qty = document.createElement("input");
      qty.type = "number";
      qty.min = STEP;
      qty.step = STEP;
      qty.value = STEP;

      const add = document.createElement("button");
      add.className = "btn btn-primary";
      add.textContent = "Tambah";
      add.addEventListener("click", ()=>{
        const q = clampQty(qty.value);
        if (q < STEP){
          alert(`Qty minimal ${STEP} dan harus kelipatan ${STEP}.`);
          return;
        }
        addToCart(it, q);
      });

      row.appendChild(qty);
      row.appendChild(add);

      const note = document.createElement("div");
      note.className = "muted";
      note.textContent = `Contoh: ${STEP}, ${STEP*2}, ${STEP*3}...`;

      card.appendChild(top);
      card.appendChild(row);
      card.appendChild(note);

      itemsEl.appendChild(card);
    });
  }

  function renderCart(){
    const entries = Object.values(cart);
    cartEl.innerHTML = "";

    if (entries.length === 0){
      const empty = document.createElement("div");
      empty.className = "muted";
      empty.textContent = "Keranjang masih kosong. Tambahkan item dari sebelah kiri.";
      cartEl.appendChild(empty);
    } else {
      entries.forEach((it)=>{
        const box = document.createElement("div");
        box.className = "cart-item";

        const meta = document.createElement("div");
        meta.className = "meta";
        const linePrice = it.qty * it.unit;

        meta.innerHTML = `
          <div style="font-weight:800">${it.label}</div>
          <div class="small">Qty: <strong style="color:var(--text)">${it.qty}</strong> ‚Ä¢ Unit: ${rupiah(it.unit)} ‚Ä¢ Subtotal: <strong style="color:var(--text)">${rupiah(linePrice)}</strong></div>
        `;

        const right = document.createElement("div");
        right.className = "right";

        const qtyInput = document.createElement("input");
        qtyInput.type = "number";
        qtyInput.min = STEP;
        qtyInput.step = STEP;
        qtyInput.value = it.qty;

        qtyInput.addEventListener("change", ()=>{
          const q = clampQty(qtyInput.value);
          if (q < STEP){
            alert(`Qty minimal ${STEP} dan harus kelipatan ${STEP}.`);
            qtyInput.value = it.qty;
            return;
          }
          it.qty = q;
          cart[it.id].qty = q;
          recalc();
        });

        const remove = document.createElement("button");
        remove.className = "btn btn-danger";
        remove.textContent = "Hapus";
        remove.addEventListener("click", ()=>{
          delete cart[it.id];
          recalc();
        });

        right.appendChild(qtyInput);
        right.appendChild(remove);

        box.appendChild(meta);
        box.appendChild(right);
        cartEl.appendChild(box);
      });
    }

    recalcTotalsUI();
  }

  // ==============================
  // CART OPS
  // ==============================
  function addToCart(item, qty){
    if (!cart[item.id]){
      cart[item.id] = { ...item, qty };
    } else {
      cart[item.id].qty += qty;
    }
    recalc();
  }

  function clearCart(){
    Object.keys(cart).forEach(k => delete cart[k]);
    recalc();
  }

  function getTotals(){
    const entries = Object.values(cart);
    const totalQty = entries.reduce((a,b)=>a+b.qty, 0);
    const totalPrice = entries.reduce((a,b)=>a + (b.qty*b.unit), 0);
    return { totalQty, totalPrice };
  }

  function validateRules(){
    const entries = Object.values(cart);
    if (entries.length === 0) return { ok:false, msg:"Keranjang kosong." };

    // setiap item harus kelipatan 100 (STEP) dan minimal 100
    for (const it of entries){
      if (it.qty < STEP || (it.qty % STEP !== 0)){
        return { ok:false, msg:`Qty ${it.label} harus kelipatan ${STEP}.` };
      }
    }

    const { totalQty } = getTotals();
    if (totalQty < STEP){
      return { ok:false, msg:`Total minimal ${STEP} item.` };
    }
    return { ok:true, msg:"OK" };
  }

  function recalcTotalsUI(){
    const { totalQty, totalPrice } = getTotals();
    totalQtyEl.textContent = totalQty.toLocaleString("id-ID");
    totalPriceEl.textContent = rupiah(totalPrice);

    const countItems = Object.values(cart).length;
    cartCountEl.textContent = `${countItems} jenis item`;

    const v = validateRules();
    if (!v.ok){
      ruleBox.style.display = "block";
      okBox.style.display = "none";
      ruleBox.textContent = v.msg + " (Minimal total 100 item, dan semua qty kelipatan 100.)";
    } else {
      ruleBox.style.display = "none";
      okBox.style.display = "block";
      okBox.textContent = "Siap dikirim. Klik ‚ÄúKirim ke WhatsApp‚Äù.";
    }
  }

  function recalc(){
    renderCart();
  }

  // ==============================
  // WHATSAPP MESSAGE
  // ==============================
  function buildWA(){
    const v = validateRules();
    if (!v.ok){
      alert(v.msg);
      return;
    }

    const name = document.getElementById("custName").value.trim();
    const user = document.getElementById("custUser").value.trim();
    const note = document.getElementById("custNote").value.trim();

    const { totalQty, totalPrice } = getTotals();
    const lines = Object.values(cart).map(it => {
      const sub = it.qty * it.unit;
      return `- ${it.label} | Qty ${it.qty} | ${rupiah(sub)}`;
    });

    const msg =
`${BRAND} ‚Äî ORDER FARMING
Nama: ${name || "-"}
Username Heartopia: ${user || "-"}

Detail Order:
${lines.join("\n")}

Total Qty: ${totalQty.toLocaleString("id-ID")}
Total Harga: ${rupiah(totalPrice)}

Catatan:
${note || "-"}

Mohon konfirmasi ketersediaan antrian & estimasi pengerjaan.`;

    const url = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`;
    window.open(url, "_blank");
  }

  // ==============================
  // INIT
  // ==============================
  renderTabs();
  renderItems();
  renderCart();

  document.getElementById("sendWA").addEventListener("click", buildWA);
  document.getElementById("clearCart").addEventListener("click", clearCart);
</script>
</body>
</html>
